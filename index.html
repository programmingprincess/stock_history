<!DOCTYPE html>
<html lang="en">
<style>
    table {
      border-collapse: collapse;
      width: 100%;
    }
    
    th, td {
      text-align: left;
      padding: 8px;
    }
    
    tr:nth-child(even){background-color: #f2f2f2}
    
    th {
      background-color: #4CAF50;
      color: white;
    }
    </style>
<head>
    <meta charset="UTF-8">
    <title>Spatial Composition</title>
    <link href="style.css" rel="stylesheet" type="text/css">

</head>
<body>
<h1 class = "title">Stock History </h1>

<h3>1. Find relevant news: </h3>
Company: <input type="text" id="myText" value="Company name">
Date: <input type="text" id="myDate" value="YYYY-MM-DD">
<button onclick = "callNewsAPI()"> Find results</button>


<div id="printme"></div>
<div class="col-md-6">
  <table id="firstTabOverall">
      <tr>
          <th>Source</th>
          <th>Title</th>
          <th>Description</th>
        </tr>
  </table>
</div>

</body>


<script>

callNewsAPI = function(dropdown) {
    searchTerm = document.getElementById("myText").value;
    date = document.getElementById("myDate").value;
    // searchTerm = dropdown.value;


    var url = 'http://newsapi.org/v2/everything?' +
              'q='+searchTerm+'&' +
              // 'to=2020-01-18&' +
              // 'to=2020-01-18&' +
              'from='+date+'&' +
              'to='+date+'&' +
              'sortBy=popularity&'+
              'apiKey=128f029c5e6c42e4ad3b15e6691cd95b';

    var req = new Request(url);
    var res = ""
    fetch(req)
        .then(function(response) {
          return response.json();
        }).then(response=>{
          // debugger
          res = response.articles[0].description;
          // debugger
          console.log(res);
          // document.getElementById("printme").innerHTML = res;
          var table = document.getElementById("firstTabOverall");

          // helper function        
          function addCell(tr, text) {
                  var td = tr.insertCell();
                  td.innerHTML = text;
                  return td;
              }
          // var thead = table.createTHead();
          // var headerRow = thead.insertRow();
          // addCell(headerRow, 'Source');
          // addCell(headerRow, 'Title');
          // addCell(headerRow, 'Description');

          // insert data
          response.articles.forEach(function (article) {
              var row = table.insertRow();
              var tit = article.title;
              var yooareel = tit.link(article.url);
              addCell(row, article.source.name);
              addCell(row, yooareel);
              addCell(row, article.description);
          });
        })


}

</script>
<script type="text/javascript" src="main.js"></script>
</html>
